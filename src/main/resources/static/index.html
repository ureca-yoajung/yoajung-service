<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YOAJUNG - AI ìš”ê¸ˆì œ ì¶”ì²œ</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/index.css"/>
</head>
<body>
    <!-- Navigation -->
    <div id="navbar"></div>
    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="hero-container">
            <div class="hero-content">
                <h1>AIê°€ ì°¾ì•„ì£¼ëŠ”<br>ë‚˜ë§Œì˜ ìš”ê¸ˆì œ</h1>
                <p>ì‚¬ìš© íŒ¨í„´ì„ ë¶„ì„í•´ ê°€ì¥ ê²½ì œì ì¸ ìš”ê¸ˆì œë¥¼ ì¶”ì²œí•´ë“œë¦½ë‹ˆë‹¤</p>
                <div class="hero-buttons">
                    <button class="btn btn-primary-hero btn-large" onclick="startRecommendation()">AI ì¶”ì²œ ë°›ê¸°</button>
                    <a href="/plan-list.html" class="btn btn-outline-hero btn-large">ìš”ê¸ˆì œ ë³´ê¸°</a>
                </div>
            </div>
            <div class="hero-image">
                <img src="/assets/image/yoajung.png" alt="ìš”ì•„ì • AI ìš”ê¸ˆì œ ì¶”ì²œ ì„œë¹„ìŠ¤ ë§ˆìŠ¤ì½”íŠ¸" loading="lazy"/>
                <!--            loading="lazy"-->
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features" id="about">
        <div class="features-container">
            <!--            <h3 class="section-title">ê°„ë‹¨í•˜ê³  ì •í™•í•œ ì¶”ì²œ</h3>-->
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">ğŸ¤–</div>
                    <h3>AI ë¶„ì„</h3>
                    <p>ì‚¬ìš© íŒ¨í„´ê³¼ ì˜ˆì‚°ì„ ë¶„ì„í•˜ì—¬</p>
                    <p>ìµœì ì˜ ìš”ê¸ˆì œë¥¼ ì°¾ì•„ë“œë¦½ë‹ˆë‹¤</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ’°</div>
                    <h3>ê°€ê²© ë¹„êµ</h3>
                    <p>LG ìœ í”ŒëŸ¬ìŠ¤ì˜ ìš”ê¸ˆì œë¥¼ ë¹„êµí•˜ì—¬</p>
                    <p>ê°€ì¥ í•©ë¦¬ì ì¸ ìš”ê¸ˆì œë¥¼ ì œì•ˆí•©ë‹ˆë‹¤</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">âš¡</div>
                    <h3>ë¹ ë¥¸ ì¶”ì²œ</h3>
                    <p>ëª‡ ê°€ì§€ ì§ˆë¬¸ë§Œìœ¼ë¡œ 30ì´ˆ ì•ˆì—</p>
                    <p>ë§ì¶¤ ìš”ê¸ˆì œë¥¼ ì¶”ì²œë°›ìœ¼ì„¸ìš”</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Plans Section -->
    <section class="plans" id="plans">
        <div class="plans-container">
            <h2 class="section-title">ì¸ê¸° ìš”ê¸ˆì œ</h2>
            <div class="plans-grid">
                <div class="plan-card">
                    <h3 class="plan-name">ë¼ì´íŠ¸</h3>
                    <div class="plan-price">35,000ì›</div>
                    <ul class="plan-features">
                        <li>ë°ì´í„° 8GB</li>
                        <li>ìŒì„±í†µí™” ê¸°ë³¸</li>
                        <li>ë¬¸ì ê¸°ë³¸</li>
                        <li>5G ì§€ì›</li>
                    </ul>
                    <button class="btn btn-primary" style="width: 100%;">ì„ íƒí•˜ê¸°</button>
                </div>
                <div class="plan-card popular">
                    <div class="popular-badge">ì¸ê¸°</div>
                    <h3 class="plan-name">ìŠ¤íƒ ë‹¤ë“œ</h3>
                    <div class="plan-price">55,000ì›</div>
                    <ul class="plan-features">
                        <li>ë°ì´í„° 100GB</li>
                        <li>ìŒì„±í†µí™” ë¬´ì œí•œ</li>
                        <li>ë¬¸ì ë¬´ì œí•œ</li>
                        <li>5G ì§€ì›</li>
                        <li>í…Œë”ë§ 10GB</li>
                    </ul>
                    <button class="btn btn-primary" style="width: 100%;">ì„ íƒí•˜ê¸°</button>
                </div>
                <div class="plan-card">
                    <h3 class="plan-name">í”„ë¦¬ë¯¸ì—„</h3>
                    <div class="plan-price">75,000ì›</div>
                    <ul class="plan-features">
                        <li>ë°ì´í„° ë¬´ì œí•œ</li>
                        <li>ìŒì„±í†µí™” ë¬´ì œí•œ</li>
                        <li>ë¬¸ì ë¬´ì œí•œ</li>
                        <li>5G ì§€ì›</li>
                        <li>í…Œë”ë§ ë¬´ì œí•œ</li>
                        <li>í•´ì™¸ë¡œë° í• ì¸</li>
                    </ul>
                    <button class="btn btn-primary" style="width: 100%;">ì„ íƒí•˜ê¸°</button>
                </div>
            </div>
            <div style="text-align: center;">
                <button class="btn btn-ghost btn-large">ëª¨ë“  ìš”ê¸ˆì œ ë³´ê¸°</button>
            </div>
        </div>
    </section>
    <!-- ì„±í–¥ ì…ë ¥ ëª¨ë‹¬ -->
    <div id="modal-bg"></div>
    <div id="tendency-modal">
        <h3>ì„±í–¥ ì •ë³´ ì…ë ¥</h3>
        <form id="tendency-form">
            <div class="form-group">
                <label class="label-form">ì›”í‰ê·  ë°ì´í„° ì‚¬ìš©ëŸ‰(GB)</label>
                <div class="slider-container">
                    <div class="slider-value" id="dataValue"></div>
                    <input type="range" min="0" max="202" value="0" class="slider" name="avgMonthlyDataGB" id="dataSlider">
                    <div class="slider-labels">
                        <span>ì—†ìŒ</span>
                        <span>ì ìŒ</span>
                        <span>ë³´í†µ</span>
                        <span>ë§ìŒ</span>
                        <span>ë¬´ì œí•œ</span>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="label-form">ì›”í‰ê·  í†µí™”ëŸ‰(ë¶„)</label>
                <div class="slider-container">
                    <div class="slider-value" id="voiceValue"></div>
                    <input type="range" min="0" max="202" value="0" class="slider" name="avgMonthlyVoiceMin" id="voiceSlider">
                    <div class="slider-labels">
                        <span>ì—†ìŒ</span>
                        <span>ì ìŒ</span>
                        <span>ë³´í†µ</span>
                        <span>ë§ìŒ</span>
                        <span>ë¬´ì œí•œ</span>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="label-form">í¬ë§ ìš”ê¸ˆì œ ê°€ê²©(ì›)</label>
                <div class="slider-container">
                    <div class="slider-value" id="priceValue"></div>
                    <input type="range" min="0" max="130000" value="0" step="1000" class="slider" name="preferencePrice" id="priceSlider" required>
                </div>
            </div>

            <div class="form-group">
                <label class="label-form">ê¸°íƒ€</label>
                <textarea name="comment" required rows="4" placeholder="ì¶”ê°€ ìš”êµ¬ì‚¬í•­ì´ë‚˜ íŠ¹ë³„í•œ ì‚¬í•­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"></textarea>
            </div>

            <button type="submit">ë“±ë¡</button>
            <button type="button" id="tendency-later">ë‹¤ìŒì— í•˜ê¸°</button>
        </form>
    </div>
    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2025 YOAJUNG. All rights reserved.</p>
    </footer>

    <!-- Chat Button -->
    <button class="chat-button" onclick="startRecommendation()" title="AI ì¶”ì²œ ë°›ê¸°">ğŸ’¬</button>

    <script src="assets/js/alert.js"></script>
    <script>
        async function renderNavButtons() {
            const navBtns = document.getElementById('nav-auth-buttons');
            if (!navBtns) return;
            try {
                const res = await fetch('/api/user/me', {credentials: 'include'});
                if (res.ok) {
                    navBtns.innerHTML = `
                    <a href="mypage.html" class="btn btn-ghost">ë§ˆì´í˜ì´ì§€</a>
                    <button id="logout-btn" class="btn btn-primary">ë¡œê·¸ì•„ì›ƒ</button>
                `;
                    document.getElementById('logout-btn').onclick = async function () {
                        await fetch('/api/auth/logout', {method: 'POST', credentials: 'include'});
                        location.href = "login.html";
                    };
                } else {
                    navBtns.innerHTML = `
                    <a href="login.html" class="btn btn-ghost">ë¡œê·¸ì¸</a>
                    <a href="signup.html" class="btn btn-primary">ì‹œì‘í•˜ê¸°</a>
                `;
                }
            } catch {
                navBtns.innerHTML = `
                <a href="login.html" class="btn btn-ghost">ë¡œê·¸ì¸</a>
                <a href="signup.html" class="btn btn-primary">ì‹œì‘í•˜ê¸°</a>
            `;
            }
        }

        // ëª¨ë‹¬ í‘œì‹œ/ìˆ¨ê¹€
        function showTendencyModal() {
            document.getElementById('modal-bg').style.display = "block";
            document.getElementById('tendency-modal').style.display = "block";
        }

        function hideTendencyModal() {
            document.getElementById('modal-bg').style.display = "none";
            document.getElementById('tendency-modal').style.display = "none";
        }


        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        document.addEventListener('DOMContentLoaded', () => {
            fetch('/assets/navbar.html')
                .then(res => res.text())
                .then(html => {
                    document.getElementById('navbar').innerHTML = html;
                    renderNavButtons();
                });

            sessionStorage.setItem('planSort', '');

            // 2. [ìµœì í™”] ë¡œê·¸ì¸ ì²´í¬ â†’ ì„±í–¥ ì²´í¬ (ìˆœì°¨ fetch)
            fetch('/api/user/me', {credentials: 'include'})
                .then(res => {
                    if (!res.ok) return null; // ë¹„ë¡œê·¸ì¸(401 ë“±): null ë°˜í™˜
                    return fetch('/api/tendency', {credentials: 'include'});
                })
                .then(res => {
                    if (!res) return; // ë¹„ë¡œê·¸ì¸: ì•„ë¬´ ê²ƒë„ ì•ˆí•¨
                    if (!res.ok) return; // ì„±í–¥ API ì—ëŸ¬: ì•„ë¬´ ê²ƒë„ ì•ˆí•¨
                    return res.json();
                })
                .then(data => {
                    // ë¡œê·¸ì¸ + ì„±í–¥ ë¯¸ì…ë ¥ â†’ ëª¨ë‹¬
                    if (data && !data.data) showTendencyModal();
                });
        });

        document.getElementById('modal-bg').onclick = hideTendencyModal;

        // ì„±í–¥ ë“±ë¡
        document.getElementById('tendency-form').onsubmit = function (e) {
            e.preventDefault();
            const obj = Object.fromEntries(new FormData(e.target));
            fetch('/api/tendency', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                credentials: 'include',
                body: JSON.stringify(obj)
            }).then(res => res.json())
                .then(data => {
                    showSuccessAlert(data.message || "ë“±ë¡ ì™„ë£Œ");
                    hideTendencyModal();
                })
                .catch(e => {
                    showErrorAlert("ë“±ë¡ ì‹¤íŒ¨");
                })
        };

        document.getElementById('tendency-later').onclick = hideTendencyModal;

        function startRecommendation() {
            window.location.href = '/chatbot.html';
        }

        const dataSlider = document.getElementById('dataSlider');
        const voiceSlider = document.getElementById('voiceSlider');
        const priceSlider = document.getElementById('priceSlider');
        const dataValue = document.getElementById('dataValue');
        const voiceValue = document.getElementById('voiceValue');
        const priceValue = document.getElementById('priceValue');

        // ìŠ¬ë¼ì´ë” ìƒ‰ìƒ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateSliderColor(slider) {
            const value = slider.value;
            const max = slider.max;
            const percentage = (value / max) * 100;

            slider.style.background = `linear-gradient(to right, #e6007e ${percentage}%, #ddd ${percentage}%)`;
        }

        // ë°ì´í„° ìŠ¬ë¼ì´ë” ì´ë²¤íŠ¸
        dataSlider.addEventListener('input', function() {
            updateSliderColor(this);
        });

        // ìŒì„±í†µí™” ìŠ¬ë¼ì´ë” ì´ë²¤íŠ¸
        voiceSlider.addEventListener('input', function() {
            updateSliderColor(this);
        });

        priceSlider.addEventListener('input', function() {
            const value = this.value;
            priceValue.textContent = value + ' ì›';
            updateSliderColor(this);
        });

        // ì´ˆê¸°ê°’ ì„¤ì •
        dataValue.textContent = '0 GB';
        voiceValue.textContent = '0 ë¶„';
        priceValue.textContent = '0 ì›';

        // ì´ˆê¸° ìŠ¬ë¼ì´ë” ìƒ‰ìƒ ì„¤ì •
        updateSliderColor(dataSlider);
        updateSliderColor(voiceSlider);
        updateSliderColor(priceSlider);
    </script>
</body>
</html>